using Helpers;

public static class QRBlockCountTable
{
    private static readonly int[,] BlockCounts = new int[40, 4]
    {
        // L, M, Q, H
        { 1, 1, 1, 1 },   // Версія 1
        { 1, 1, 1, 2 },   // Версія 2
        { 1, 1, 2, 2 },   // Версія 3
        { 1, 2, 2, 4 },   // Версія 4
        { 1, 2, 2, 2 },   // Версія 5
        { 2, 4, 4, 4 },   // Версія 6
        { 2, 4, 6, 5 },   // Версія 7
        { 2, 4, 6, 6 },   // Версія 8
        { 2, 5, 8, 8 },   // Версія 9
        { 4, 5, 8, 8 },   // Версія 10
        { 4, 5, 8, 11 },  // Версія 11
        { 4, 8, 10, 11 }, // Версія 12
        { 4, 9, 12, 16 }, // Версія 13
        { 4, 9, 16, 16 }, // Версія 14
        { 6, 10, 12, 18 },// Версія 15
        { 6, 10, 17, 16 },// Версія 16
        { 6, 11, 16, 19 },// Версія 17
        { 7, 13, 18, 21 },// Версія 18
        { 8, 14, 21, 25 },// Версія 19
        { 8, 16, 20, 25 },// Версія 20
        { 9, 17, 23, 25 },// Версія 21
        { 9, 17, 23, 34 },// Версія 22
        { 10, 17, 25, 30 },// Версія 23
        { 10, 18, 27, 32 },// Версія 24
        { 11, 20, 29, 35 },// Версія 25
        { 12, 21, 34, 37 },// Версія 26
        { 12, 23, 34, 40 },// Версія 27
        { 13, 25, 35, 42 },// Версія 28
        { 14, 26, 38, 45 },// Версія 29
        { 15, 28, 40, 48 },// Версія 30
        { 16, 29, 43, 51 },// Версія 31
        { 17, 31, 45, 54 },// Версія 32
        { 18, 33, 48, 57 },// Версія 33
        { 19, 35, 51, 60 },// Версія 34
        { 19, 37, 53, 63 },// Версія 35
        { 20, 38, 56, 66 },// Версія 36
        { 21, 40, 59, 70 },// Версія 37
        { 22, 43, 62, 74 },// Версія 38
        { 24, 45, 65, 77 },// Версія 39
        { 25, 47, 68, 81 } // Версія 40
    };

    public static int GetBlockCount(int version, ErrorCorrectionLevel level)
    {
        if (version < 1 || version > 40)
            throw new ArgumentOutOfRangeException(nameof(version), "Версія повинна бути від 1 до 40.");

        int levelIndex = level switch
        {
            ErrorCorrectionLevel.L => 0,
            ErrorCorrectionLevel.M => 1,
            ErrorCorrectionLevel.Q => 2,
            ErrorCorrectionLevel.H => 3,
            _ => throw new ArgumentException("Невідомий рівень корекції помилок.", nameof(level))
        };

        return BlockCounts[version - 1, levelIndex];
    }
}
